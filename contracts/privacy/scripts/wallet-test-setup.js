/**
 * Wallet Test Setup Script
 *
 * This script deploys contracts and outputs configuration for MetaMask/Rabby testing.
 *
 * Usage:
 *   1. Start local node: npx hardhat node
 *   2. In another terminal: npx hardhat run scripts/wallet-test-setup.js --network localhost
 *   3. Configure your wallet with the displayed settings
 */

const hre = require("hardhat");

async function main() {
    console.log("\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—");
    console.log("â•‘         WATTx Privacy - Wallet Integration Setup             â•‘");
    console.log("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");

    const [deployer, user1, user2] = await hre.ethers.getSigners();
    const network = await hre.ethers.provider.getNetwork();

    console.log("Network:", network.name);
    console.log("Chain ID:", network.chainId.toString());
    console.log("Deployer:", deployer.address);
    console.log("");

    // Deploy contracts
    console.log("ðŸ“¦ Deploying contracts...\n");

    // MockUSDT
    const MockUSDT = await hre.ethers.getContractFactory("MockUSDT");
    const mockUSDT = await MockUSDT.deploy();
    await mockUSDT.waitForDeployment();
    const mockUSDTAddress = await mockUSDT.getAddress();
    console.log("âœ“ MockUSDT deployed to:", mockUSDTAddress);

    // MockVerifier
    const MockVerifier = await hre.ethers.getContractFactory("MockVerifier");
    const mockVerifier = await MockVerifier.deploy();
    await mockVerifier.waitForDeployment();
    const mockVerifierAddress = await mockVerifier.getAddress();
    console.log("âœ“ MockVerifier deployed to:", mockVerifierAddress);

    // MerkleTree
    const MerkleTreeTest = await hre.ethers.getContractFactory("MerkleTreeTest");
    const merkleTree = await MerkleTreeTest.deploy(20);
    await merkleTree.waitForDeployment();
    const merkleTreeAddress = await merkleTree.getAddress();
    console.log("âœ“ MerkleTree deployed to:", merkleTreeAddress);

    // Mint some tokens to test accounts
    console.log("\nðŸ’° Minting test tokens...\n");
    await mockUSDT.mint(user1.address, hre.ethers.parseUnits("100000", 6));
    await mockUSDT.mint(user2.address, hre.ethers.parseUnits("50000", 6));
    console.log("âœ“ Minted 100,000 USDT to", user1.address);
    console.log("âœ“ Minted 50,000 USDT to", user2.address);

    // Output wallet configuration
    console.log("\n");
    console.log("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—");
    console.log("â•‘                    WALLET CONFIGURATION                       â•‘");
    console.log("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");

    console.log("â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”");
    console.log("â”‚ Add Network to MetaMask/Rabby:                              â”‚");
    console.log("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤");
    console.log("â”‚ Network Name: Hardhat Local                                 â”‚");
    console.log("â”‚ RPC URL:      http://127.0.0.1:8545                         â”‚");
    console.log("â”‚ Chain ID:     31337                                         â”‚");
    console.log("â”‚ Symbol:       ETH                                           â”‚");
    console.log("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n");

    console.log("â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”");
    console.log("â”‚ Import Test Accounts (Private Keys):                        â”‚");
    console.log("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤");
    console.log("â”‚ Account #0 (Deployer - 10000 ETH):                          â”‚");
    console.log("â”‚ 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80");
    console.log("â”‚                                                             â”‚");
    console.log("â”‚ Account #1 (User1 - 10000 ETH + 100k USDT):                 â”‚");
    console.log("â”‚ 0x59c6995e998f97a5a0044966f0945389dc9e86dae88c7a8412f4603b6b78690d");
    console.log("â”‚                                                             â”‚");
    console.log("â”‚ Account #2 (User2 - 10000 ETH + 50k USDT):                  â”‚");
    console.log("â”‚ 0x5de4111afa1a4b94908f83103eb1f1706367c2e68ca870fc3fb9a804cdab365a");
    console.log("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n");

    console.log("â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”");
    console.log("â”‚ Add Custom Token (MockUSDT):                                â”‚");
    console.log("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤");
    console.log(`â”‚ Token Address: ${mockUSDTAddress}â”‚`);
    console.log("â”‚ Token Symbol:  USDT                                         â”‚");
    console.log("â”‚ Decimals:      6                                            â”‚");
    console.log("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n");

    console.log("â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”");
    console.log("â”‚ Deployed Contract Addresses:                                â”‚");
    console.log("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤");
    console.log(`â”‚ MockUSDT:     ${mockUSDTAddress}â”‚`);
    console.log(`â”‚ MockVerifier: ${mockVerifierAddress}â”‚`);
    console.log(`â”‚ MerkleTree:   ${merkleTreeAddress}â”‚`);
    console.log("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n");

    // Test interactions
    console.log("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—");
    console.log("â•‘                    TEST INTERACTIONS                          â•‘");
    console.log("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");

    console.log("Test 1: USDT Faucet (get 10,000 USDT)");
    console.log("  Contract: " + mockUSDTAddress);
    console.log("  Function: faucet()");
    console.log("  Data:     0x7b56c2b2");
    console.log("");

    console.log("Test 2: Insert Commitment to Privacy Pool");
    console.log("  Contract: " + merkleTreeAddress);
    console.log("  Function: insert(bytes32 leaf)");
    console.log("  Example leaf: 0x" + "a".repeat(64));
    console.log("");

    console.log("Test 3: Check USDT Balance");
    console.log("  Contract: " + mockUSDTAddress);
    console.log("  Function: balanceOf(address)");
    console.log("  View call - no gas needed");
    console.log("");

    // For Altcoinchain mainnet
    console.log("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—");
    console.log("â•‘               ALTCOINCHAIN MAINNET CONFIG                     â•‘");
    console.log("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");

    console.log("â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”");
    console.log("â”‚ Network Name: Altcoinchain                                  â”‚");
    console.log("â”‚ RPC URL:      https://alt-rpc2.minethepla.net               â”‚");
    console.log("â”‚ Chain ID:     2330                                          â”‚");
    console.log("â”‚ Symbol:       ALT                                           â”‚");
    console.log("â”‚ Explorer:     https://explorer.altcoinchain.org             â”‚");
    console.log("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n");

    console.log("ðŸŽ‰ Setup complete! You can now interact with contracts via your wallet.\n");

    // Return addresses for scripting
    return {
        mockUSDT: mockUSDTAddress,
        mockVerifier: mockVerifierAddress,
        merkleTree: merkleTreeAddress,
        chainId: network.chainId.toString()
    };
}

main()
    .then((addresses) => {
        console.log("Exported addresses:", JSON.stringify(addresses, null, 2));
        process.exit(0);
    })
    .catch((error) => {
        console.error(error);
        process.exit(1);
    });
